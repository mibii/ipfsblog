// JSON Data for the blog post
const blogPost = {
    title: "Blockchain: The Trust Revolution in a World of Manipulated Information",
    author: "Alex",
    date: "2024-09-01",
    tags: ["blockchain", "cryptocurrency", "trust", "transparency", "decentralization"],
    imageUrl: "1.png",
    imageAlt: "Blockchain concept illustration",
    content: {
        introduction: "Many are speculating about the reasons for Pavel Durov's arrest, worrying about the fate of his messenger Telegram. But Durov's main creation is NOT Telegram, but his blockchain and cryptocurrency called TON. And the 'fate of cryptocurrency' and blockchain, if it is truly a cryptocurrency and blockchain, does not depend on Durov or anyone else. The example of Bitcoin showed us that the value of numbers appears not when they 'acquire backing,' but when the information about their quantity cannot be changed to suit someone's interests. Thanks to Satoshi Nakamoto for blockchain.",
        body: [
            {
                heading: "The Power of Reliable Information",
                paragraphs: [
                    "Let me remind you—the very ability to have reliable information (to have blockchain) has proven stronger than many of the economic laws proposed to us. The value of the inability to make changes and adjustments to information after it is recorded on the blockchain has made the information unprecedentedly reliable. Reliable not in the sense that it made it true, but made it reliable compared to itself yesterday or the day before, and at any other moment after it was recorded on the blockchain. And I believe that this greatest property of this tool has yet to be fully appreciated.",
                    "For the first time in history, there is a place for writing documents, before which everyone is equal, which do not 'bow their heads' and submit to kings and those in power."
                ]
            },
            {
                heading: "Satoshi Nakamoto's Brilliant Combination",
                paragraphs: [
                    "Satoshi Nakamoto did not invent the components that formed the basis of the blockchain. Everything he used existed separately before (Asymmetric encryption, Hashing, Digital signatures, Consensus algorithms). But in the way he used it, it became a unique way of storing information without the possibility of changing it. And this is truly the greatest invention. This world has never existed under conditions where information could not be changed. 'What is written with a pen...' (contrary to the well-known saying) can be rewritten, in a desired form, in the interests or under the pretext of the interests of the state, the king, those in power... and so on. The question of correcting inconvenient information to the needed one is not difficult for those whose power is great."
                ]
            },
            {
                heading: "Rethinking Economics and Jurisprudence",
                paragraphs: [
                    "An interesting question arises: if such a reliable place appeared only in our time, on what basis were we taught economics and jurisprudence as sciences? In times when there was no technical possibility of continuously checking the state of information—economics and jurisprudence relied on assumptions and conventions. It turns out that if such a 'science' operates on conditions and assumptions, then no laws with cause-and-effect relationships could be discussed in these so-called sciences. Without a tool for ensuring the reliability of information and the ability to continuously verify it, consequences and conclusions will always be just conventions, unrelated to reality.",
                    "It turns out that only now is the world beginning to approach real, not conventional, economics and jurisprudence, and finding real, genuine laws of economics and social science will be possible when every person realizes the unique historical period of time they live in and abandons relationships that require their trust. And the laws will take on their real contours when the 'rules of the game' stop being in favor of insiders and those close to power. But that moment is still far off, for one simple reason—those in power, taking advantage of the majority's lack of understanding of what blockchain is, still avoid blockchain, which would make their work transparent and open.",
                    "They will delay the moment of comprehensive implementation of this technology in their work, document flow, and payments, using all sorts of invented pretexts.",
                    "I am writing completely obvious things, but in fact, not many people have an understanding of this phenomenon even at this level. This conclusion can be drawn by observing the number of people who continue to store their funds, for example, on centralized exchanges (and all popular exchanges and crypto exchanges are centralized), continue to save in fiat money (the issuance of which is fully controlled by the state), and continue to participate in voting systems, based on their belief that the result of the vote count will be fair.",
                    "People continue to be imposed with systems based on their trust when they can demand transparency based on blockchain. The world already has a technical tool that guarantees reliability based on transparency. (Blockchain—a tool for ensuring the reliability of information and the ability to continuously verify it). Using which, for example, a voter can, if desired, see their vote in the blockchain-based system, even after the vote ends, see how it is counted, and that it is indeed counted in favor of whom they voted for.",
                    "It has always been strange to observe the governments of countries striving to create their own blockchain. You can only create your own blockchain for one reason—when you have a reason not to trust the existing one or you intend to deceive—calling a blockchain something that is not.",
                    "Most often, governments create and call blockchain something that has nothing to do with it (with their own blackjack and ...). We are witnessing how those whose work should be open and transparent, under various pretexts, continue to avoid this openness and transparency. We are witnessing attempts to prohibit the spread of information about the true meaning of blockchain for society. Many do not realize the depth of these changes that blockchain brings."
                ]
            },
            {
                heading: "Why Change Happens Slowly",
                paragraphs: [
                    "People's reluctance to abandon familiar systems—many continue to store their funds on centralized exchanges, trust fiat money, and participate in traditional voting systems, despite the risks and shortcomings of these systems. This indicates that changing mindsets and habits happens slowly.",
                    "Attempts by states to imitate blockchain—many governments try to create their own blockchains, but often it's just an imitation, lacking the key properties of decentralization and immutability. This is an attempt to maintain control and not let blockchain technology truly change the system.",
                    "Resistance to openness and transparency. Those accustomed to opacity and control fear the openness that blockchain brings. They try to prohibit the dissemination of information about the real significance of this technology. We are witnessing how those whose work should be open and transparent continue to avoid this openness and transparency under different pretexts. We observe attempts to prohibit the spread of information about the true meaning of blockchain for society."
                ]
            },
            {
                heading: "Freedom of Speech, Censorship, and Anonymity",
                paragraphs: [
                    "The concepts of freedom of speech and censorship are often mistakenly associated with anonymity. However, it is important to understand that true freedom of speech does not require anonymity. On the contrary, words spoken in the name of freedom must be heard openly and clearly. Some platform may promise anonymity or lack of censorship.",
                    "But it is worth saying that freedom of speech does not critically need anonymity; it requires the absence of censorship. Yes, the latter is much more important, and we must remind everyone that censorship is impossible when there is blockchain. Many do not know this, but I repeat, blockchain is not about cryptocurrencies; it is about a unique way of storing information, without the possibility of its censorship.",
                    "When it comes to human rights and freedom of expression, it always manifests itself in the form of open statements, demands, declarations, and manifestos. Such freedom of speech always has a name and a face. Anonymous demands or statements about one's rights lose their power and meaning.",
                    "True freedom of speech implies the readiness to openly defend one's beliefs, to take responsibility for one's words. This is not only a right but also a duty of a citizen in a free society. Anonymity may be necessary in certain situations, but it should not become the norm of expressing a civic position and defending human rights."
                ]
            }
        ],
        conclusion: "This world has always belonged to insiders, the powerful, and those close to power. And this continues. Laws will take real shape when the 'rules of the game' are equally transparent for everyone. When most people understand the true meaning of blockchain technology for society and begin to massively reject systems that require their trust and demand reliability based on blockchain, only then will the time come to find real laws of economics and jurisprudence."
    },
   comments: [
        {
            user: "author's comment",
            date: "2024-09-01",
            comment: "Demonstrating your understanding is important, and it can trigger positive change. People think they live in a world of laws, but they live in a world of deals. This is because following the law is a great responsibility, and in deals, the responsibility lies with the one who accepted the deal. In a world of deals, any conditions can be set, and responsibility can be completely removed, which is what happens. You all know the example from business—how companies limit their liability to clients and potential clients using the suffix LLC (Limited Liability Company), but this principle applies everywhere and even in power. Limiting and insuring their liability is important to them when they need to imitate power and convince citizens to make deals, rather than apply laws. What's the problem with living by the law? The fact is that an unlawful law imposes responsibility on the one who created and signed it. Therefore, those who create not only unlawful but often inhumane laws, in reality, almost never apply them in practice. They always strive to impose deals (contracts) instead, which is why such «laws» are often not applied in practice but serve only as «props for a magician.» When there are attributes of power, you do not notice the trick. The trick is that the appearance turns out to be a facade, and the «dance being performed» is an invitation to a deal, not a requirement to follow the law. They do not use their authoritative powers when inviting people to their own execution or granting a license to kill. «It's not my fault, he came himself.» If he came himself, then it is a conclusive deal, meaning he agreed to the proposed role and took full responsibility upon himself. The weapon against all this is the open demonstration of your understanding of what is happening, revealing your understanding by demonstrating it, and stopping attempts by those who should enforce the law from using only bill-of-exchange law—the right to create deals and secretly shift responsibility to the one who accepts this deal."
        }
    ]
};

// Function to render the blog post
function renderBlogPost(post) {
    const articleElement = document.querySelector('article');
    const commentsSection = document.querySelector('section:last-of-type');

    // Set the title and author/date information
    articleElement.innerHTML = `
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-gray-100">${post.title}</h1>
            <p class="text-gray-400 mt-2">by <span class="text-gray-200">${post.author}</span> | <span>${post.date}</span></p>
            <div class="mt-4">
                ${post.tags.map(tag => `<span class="inline-block bg-gray-700 text-gray-300 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">${tag}</span>`).join('')}
            </div>
			 <img src="${post.imageUrl}" alt="${post.imageAlt}" class="w-full h-auto mt-6 rounded-lg shadow-lg">
        </header>
    `;

    // Set the introduction
    articleElement.innerHTML += `
        <section class="mb-8">
            <p class="text-lg leading-7 mb-4">${post.content.introduction}</p>
        </section>
    `;

    // Set the body content
    post.content.body.forEach(section => {
        articleElement.innerHTML += `
            <section class="mb-8">
                <h2 class="text-2xl font-semibold text-gray-200 mb-4">${section.heading}</h2>
                ${section.paragraphs.map(paragraph => `<p class="leading-7 mb-4">${paragraph}</p>`).join('')}
            </section>
        `;
    });

    // Set the conclusion
    articleElement.innerHTML += `
        <footer class="border-t border-gray-700 pt-6">
            <p class="text-xl font-semibold text-gray-200">Conclusion</p>
            <p class="leading-7 mt-4">${post.content.conclusion}</p>
        </footer>
    `;

    // Set the comments
    commentsSection.innerHTML = ''; // Clear existing comments
    post.comments.forEach(comment => {
        commentsSection.innerHTML += `
            <div class="bg-gray-800 p-6 rounded-lg shadow-lg mb-4">
                <p class="text-gray-400 mb-2">${comment.user} | ${comment.date}</p>
                <p class="text-gray-300">${comment.comment}</p>
            </div>
        `;
    });
}

document.addEventListener('DOMContentLoaded', function () {
    const themeSwitch = document.getElementById('theme-switch');
    const currentTheme = localStorage.getItem('theme') || 'dark';
    
    if (currentTheme === 'light') {
        document.body.classList.add('light');
        themeSwitch.checked = true;
    }

    themeSwitch.addEventListener('change', function () {
        if (themeSwitch.checked) {
            document.body.classList.add('light');
            localStorage.setItem('theme', 'light');
        } else {
            document.body.classList.remove('light');
            localStorage.setItem('theme', 'dark');
        }
    });

const fetchButton = document.getElementById('fetch-post');
    const clearButton = document.getElementById('clear-inputs');
    const ipfsInput = document.getElementById('ipfs-address');
    const gatewayInput = document.getElementById('ipfs-gateway');
    const warningMessage = document.getElementById('warning-message');
    const errorMessage = document.getElementById('error-message');

    fetchButton.addEventListener('click', async function () {
        const address = ipfsInput.value.trim();
        const gateway = gatewayInput.value.trim();

        if (address === '' || gateway === '') {
            warningMessage.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            return;
        }

        warningMessage.classList.add('hidden');
        errorMessage.classList.add('hidden');
        const apiUrl = `${gateway}${address}`;

        try {
            const response = await fetch(apiUrl);
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            const blogPost = await response.json();

            // Validate that blogPost has the expected structure
            if (!blogPost.title || !blogPost.content) {
                throw new Error('Invalid blog post format');
            }

            renderBlogPost(blogPost);
        } catch (error) {
            console.error('There was a problem with the fetch operation:', error);
            errorMessage.classList.remove('hidden');
        }
    });

    clearButton.addEventListener('click', function () {
        // Clear the input fields
        ipfsInput.value = '';
        gatewayInput.value = '';
        
        // Hide any warning or error messages
        warningMessage.classList.add('hidden');
        errorMessage.classList.add('hidden');
    });

    // Call the function to render the initial blog post if needed
    // renderBlogPost(blogPost); // Uncomment if you want to render an initial post
});